name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Pages
        uses: actions/configure-pages@v4
          
      - name: Create documentation site
        run: |
          mkdir -p _site
          cp README.md _site/index.md
          
          # Create a simple HTML index from README
          cat > _site/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="en">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>ğŸŒŸ Retail Watch Store - AI-Powered Customer 360</title>
              <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
              <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css">
              <style>
                  .hero-section {
                      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                      color: white;
                      padding: 4rem 0;
                  }
                  .feature-card {
                      transition: transform 0.3s;
                      height: 100%;
                  }
                  .feature-card:hover {
                      transform: translateY(-5px);
                  }
                  .code-block {
                      background: #f8f9fa;
                      border-left: 4px solid #007bff;
                      padding: 1rem;
                      margin: 1rem 0;
                  }
              </style>
          </head>
          <body>
              <!-- Hero Section -->
              <section class="hero-section text-center">
                  <div class="container">
                      <h1 class="display-4 mb-4">ğŸŒŸ Retail Watch Store</h1>
                      <p class="lead mb-4">AI-Powered Customer 360 Platform</p>
                      <p class="mb-4">Complete customer 360 platform featuring <strong>churn prediction</strong>, <strong>sentiment analysis</strong>, <strong>price optimization</strong>, and <strong>personal shopper experience</strong></p>
                      <a href="#features" class="btn btn-light btn-lg me-3">Explore Features</a>
                      <a href="#quick-start" class="btn btn-outline-light btn-lg">Quick Start</a>
                  </div>
              </section>

              <!-- Features Section -->
              <section id="features" class="py-5">
                  <div class="container">
                      <h2 class="text-center mb-5">âœ¨ Key Features</h2>
                      <div class="row">
                          <div class="col-md-6 col-lg-3 mb-4">
                              <div class="card feature-card h-100">
                                  <div class="card-body text-center">
                                      <div class="mb-3">ğŸ¤–</div>
                                      <h5 class="card-title">Churn Prediction</h5>
                                      <p class="card-text">AI-powered identification of at-risk customers with 85%+ accuracy</p>
                                  </div>
                              </div>
                          </div>
                          <div class="col-md-6 col-lg-3 mb-4">
                              <div class="card feature-card h-100">
                                  <div class="card-body text-center">
                                      <div class="mb-3">ğŸ˜Š</div>
                                      <h5 class="card-title">Sentiment Analysis</h5>
                                      <p class="card-text">Real-time analysis of customer reviews and feedback</p>
                                  </div>
                              </div>
                          </div>
                          <div class="col-md-6 col-lg-3 mb-4">
                              <div class="card feature-card h-100">
                                  <div class="card-body text-center">
                                      <div class="mb-3">ğŸ’°</div>
                                      <h5 class="card-title">Price Optimization</h5>
                                      <p class="card-text">Dynamic pricing based on demand and market conditions</p>
                                  </div>
                              </div>
                          </div>
                          <div class="col-md-6 col-lg-3 mb-4">
                              <div class="card feature-card h-100">
                                  <div class="card-body text-center">
                                      <div class="mb-3">ğŸ›ï¸</div>
                                      <h5 class="card-title">Personal Shopper</h5>
                                      <p class="card-text">AI-driven recommendations tailored to individual preferences</p>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </section>

              <!-- Quick Start Section -->
              <section id="quick-start" class="py-5 bg-light">
                  <div class="container">
                      <h2 class="text-center mb-5">ğŸš€ Quick Start</h2>
                      <div class="row">
                          <div class="col-lg-8 mx-auto">
                              <div class="code-block">
                                  <h5>1. Database Setup</h5>
                                  <pre><code class="language-sql">-- Execute in Snowflake
@sql/99_deploy_complete.sql</code></pre>
                              </div>
                              <div class="code-block">
                                  <h5>2. Configure Credentials</h5>
                                  <pre><code class="language-toml">[snowflake]
user = "your_username"
password = "your_password"
account = "your_account_identifier"
warehouse = "RETAIL_WATCH_WH"
database = "RETAIL_WATCH_DB"</code></pre>
                              </div>
                              <div class="code-block">
                                  <h5>3. Launch Application</h5>
                                  <pre><code class="language-bash">pip install -r requirements.txt
cd streamlit
streamlit run watch_store_app.py</code></pre>
                              </div>
                          </div>
                      </div>
                  </div>
              </section>

              <!-- Architecture Section -->
              <section class="py-5">
                  <div class="container">
                      <h2 class="text-center mb-5">ğŸ—ï¸ Architecture</h2>
                      <div class="row">
                          <div class="col-lg-8 mx-auto text-center">
                              <div class="card">
                                  <div class="card-body">
                                      <h6 class="text-muted mb-3">Data Flow Architecture</h6>
                                      <div class="row">
                                          <div class="col-md-3 mb-3">
                                              <div class="p-3 bg-primary text-white rounded">Customer Data</div>
                                          </div>
                                          <div class="col-md-3 mb-3">
                                              <div class="p-3 bg-info text-white rounded">Snowflake AI</div>
                                          </div>
                                          <div class="col-md-3 mb-3">
                                              <div class="p-3 bg-success text-white rounded">AI Functions</div>
                                          </div>
                                          <div class="col-md-3 mb-3">
                                              <div class="p-3 bg-warning text-white rounded">Streamlit App</div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </section>

              <!-- Watch Brands Section -->
              <section class="py-5 bg-light">
                  <div class="container">
                      <h2 class="text-center mb-5">âŒš Watch Catalog</h2>
                      <div class="row">
                          <div class="col-md-4 mb-4">
                              <div class="card">
                                  <div class="card-body text-center">
                                      <h5 class="card-title">ğŸ† Luxury</h5>
                                      <p class="card-text">Rolex, Omega, TAG Heuer</p>
                                      <small class="text-muted">Premium Swiss timepieces</small>
                                  </div>
                              </div>
                          </div>
                          <div class="col-md-4 mb-4">
                              <div class="card">
                                  <div class="card-body text-center">
                                      <h5 class="card-title">âš¡ Smart</h5>
                                      <p class="card-text">Apple Watch</p>
                                      <small class="text-muted">Connected health & fitness</small>
                                  </div>
                              </div>
                          </div>
                          <div class="col-md-4 mb-4">
                              <div class="card">
                                  <div class="card-body text-center">
                                      <h5 class="card-title">ğŸ¯ Sport</h5>
                                      <p class="card-text">Seiko, Citizen, Casio</p>
                                      <small class="text-muted">Active lifestyle timepieces</small>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </section>

              <!-- Footer -->
              <footer class="bg-dark text-white py-4">
                  <div class="container text-center">
                      <p class="mb-0">ğŸŒŸ Ready to transform your watch retail business with AI-powered customer 360? âŒš</p>
                      <p class="mb-0 mt-2">
                          <a href="https://github.com" class="text-white me-3">ğŸ“ View Code</a>
                          <a href="#quick-start" class="text-white">ğŸš€ Get Started</a>
                      </p>
                  </div>
              </footer>

              <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
              <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
              <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
          </body>
          </html>
          EOF
          
          # Copy important documentation files
          mkdir -p _site/docs
          if [ -f "sql/README.md" ]; then cp sql/README.md _site/docs/sql-guide.md; fi
          if [ -f "streamlit/README.md" ]; then cp streamlit/README.md _site/docs/streamlit-guide.md; fi
          
          # Create project structure page
          cat > _site/project-structure.html << 'EOF'
          <!DOCTYPE html>
          <html>
          <head>
              <title>Project Structure - Retail Watch Store</title>
              <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
          </head>
          <body>
              <div class="container py-5">
                  <h1>ğŸ“ Project Structure</h1>
                  <pre class="bg-light p-3">
          customer360/
          â”œâ”€â”€ sql/
          â”‚   â”œâ”€â”€ 00_reset_demo.sql          # Reset script
          â”‚   â”œâ”€â”€ 01_setup_database.sql      # Database setup
          â”‚   â”œâ”€â”€ 02_create_tables.sql       # Table creation
          â”‚   â”œâ”€â”€ 03_sample_data.sql         # Sample data
          â”‚   â”œâ”€â”€ 04_ai_functions.sql        # AI functions
          â”‚   â””â”€â”€ 99_deploy_complete.sql     # Complete deployment
          â”œâ”€â”€ streamlit/
          â”‚   â”œâ”€â”€ watch_store_app.py         # Main Streamlit app
          â”‚   â”œâ”€â”€ utils/
          â”‚   â”‚   â””â”€â”€ database.py            # Database utilities
          â”‚   â””â”€â”€ .streamlit/
          â”‚       â””â”€â”€ secrets.toml           # Snowflake credentials
          â”œâ”€â”€ requirements.txt               # Python dependencies
          â””â”€â”€ README.md                      # Documentation
                  </pre>
                  <a href="index.html" class="btn btn-primary">â† Back to Home</a>
              </div>
          </body>
          </html>
          EOF
          
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./_site

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4 